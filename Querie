--Ejercicio 1
select first_name, last_name, email 
from customer c join address a on (c.address_id=a.address_id) 
join city c2 on (a.city_id=c2.city_id)
join country c3 on (c2.country_id= c3.country_id)
where c3.country = 'Canada';


--Ejercicio2

select first_name, last_name, count(r.rental_id)
from customer c join rental r on (c.customer_id=r.customer_id)
join inventory i on (r.inventory_id=i.inventory_id)
join film f on (i.film_id=f.film_id)
where f.rating = 'NC-17' or f.rating = 'R'
group by c.first_name, c.last_name 
order by count(r.rental_id) desc
limit 1;

--Ejercicio 3

select f2.title, count(r.rental_id) 
from film f2 join inventory i2 on(f2.film_id=i2.film_id)
join rental r on (i2.inventory_id =r.inventory_id)
group by f2.title
order by count(r.rental_id) desc

--Ejercicio 4

select s.store_id, sum(p.amount) as "Revenue"
from store s join customer c on (s.store_id=c.store_id)
join payment p on (c.customer_id=p.customer_id)
group by s.store_id 
order by s.store_id ;
